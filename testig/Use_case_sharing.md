# UC-1: Поделиться файлом из СберЧата во внешнее приложение

## User Story
US-1: Как пользователь СберЧата, я хочу поделиться файлом из чата во внешнее приложение, чтобы получатель мог скачать файл по ссылке.

## Участники
- Основной: Пользователь СберЧата
- Вторичные: 
  - МП СберЧат
  - Диск (хранилище файлов)
  - Внешнее приложение (получатель)

## Предусловия
- Пользователь находится в ленте чата
- В чат был отправлен минимум 1 файл

## Ограничения
- Файл должен пройти проверку DLP
- В хранилище пользователя должно быть достаточно места
- Максимальный размер файла: 100 МБ

## Триггер
Пользователь хочет поделиться ссылкой на файл из СберЧата во внешнее приложение

## Основной сценарий

| Шаг | Действие | Результат |
|-----|----------|-----------|
| 1 | Пользователь вызывает режим мультивыбора в ленте чата | Отображается контекстное меню |
| 2 | Пользователь выбирает сообщение с файлом | Сообщение выделено |
| 3 | СберЧат отображает опцию "Поделиться" в нижнем баре | Кнопка "Поделиться" доступна |
| 4 | Пользователь нажимает "Поделиться" | Открывается экран шаринга |
| 5 | Пользователь выбирает получателя и подтверждает отправку | Запускается процесс отправки |
| 6 | СберЧат отправляет файл в Диск для генерации ссылки | Файл передается в хранилище |
| 7 | Диск проверяет наличие места | Если место есть, файл сохраняется |
| 8 | Диск генерирует ссылку и пароль | Ссылка и пароль готовы |
| 9 | Диск отправляет данные в СберЧат | СберЧат получает ссылку и пароль |
| 10 | СберЧат отправляет получателю ссылку с паролем | Получатель получает доступ к файлу |

## Альтернативные сценарии

### A1: Недостаточно места в хранилище
1. На шаге 7: Если места нет, Диск возвращает ошибку
2. СберЧат показывает уведомление "Недостаточно места в хранилище"
3. Процесс завершается

### A2: Файл не прошел проверку DLP
1. На шаге 10: Если DLP проверка не пройдена
2. СберЧат получает уведомление о блокировке файла
3. Пользователь получает сообщение "Файл не может быть отправлен по соображениям безопасности"

## Постусловия
- Файл сохранен в хранилище пользователя
- Ссылка с паролем отправлена получателю
- Получатель может скачать файл по ссылке