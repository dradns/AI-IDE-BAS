### 4.3. 检查项目中业务和系统分析师的需求和工件质量

#### 4.3.1. 高级分析师的需求检查指南

- 用中文写的

- 本文档用于检查由AI代理生成的需求，以确保符合业务和系统分析的最佳实践。使用下面的检查清单和建议来评估需求的完整性、正确性和质量。

- 您必须检查工作目录中的需求

- 强调功能和非功能需求的逻辑性

- 检查需求后的报告应出现在reports文件夹中（如果不存在，则创建！），文件命名格式 - {您检查的需求名称}_report.md

- 如果没有线框图或BPMN，这不关键，因为我们使用.md格式，但仍然要报告

---

#### 4.3.2. 高级分析师的方法论

高质量需求的四大支柱：

1. **逻辑完整性**
需求应形成一个连贯的系统，其中每个元素都逻辑上源自前一个元素并支持解决方案的整体架构。

2. **完整性**
解决方案的所有方面都应被需求覆盖：功能性、非功能性、集成性、安全性、性能。

3. **一致性**
需求在任何层面上都不应相互冲突：业务逻辑、技术实现、用户体验。

4. **无歧义性**
每个需求都应有唯一的解释，并且所有利益相关者都能理解。

---

#### 4.3.3. 高级分析师的检查流程

##### 4.3.3.1. 阶段1：需求包的结构分析

**目标**：确保所有必要工件的存在及其正确结构

**待检查工件**：
工作目录和子文件夹中的工件

##### 4.3.3.2. 阶段2：逻辑完整性检查

**2.1. 垂直追溯**
- [ ] User Story → Use Case：每个故事都有详细的场景覆盖
- [ ] Use Case → 序列图：每个场景都有技术实现
- [ ] Use Case → 活动图：业务流程与功能相对应
- [ ] Sequence → 组件图：交互与架构相对应
- [ ] Component → ERD：架构支持数据模型
- [ ] ERD → OpenAPI：API与数据结构相对应

**2.2. 水平一致性**
- [ ] 所有User Stories和Use Cases中的角色相同
- [ ] 图表和规范中的术语统一
- [ ] 工件间时间特性的兼容性
- [ ] 详细程度的一致性

**2.3. 业务流程逻辑**
- [ ] 活动图中的因果关系
- [ ] 分支条件和循环的正确性
- [ ] 所有级别的异常情况处理
- [ ] 技术解决方案符合业务规则

##### 4.3.3.3. 阶段3：完整性检查

**3.1. 功能完整性**
- [ ] **CRUD操作**：所有实体的创建、读取、更新、删除
- [ ] **生命周期**：业务对象的所有状态和转换
- [ ] **集成**：所有外部系统和集成点
- [ ] **用户角色**：所有角色及其访问权限
- [ ] **业务流程**：主要、替代、异常场景

**3.2. 技术完整性**
- [ ] **架构层**：表示层、逻辑层、数据层、集成层
- [ ] **安全组件**：认证、授权、审计
- [ ] **错误处理**：架构的所有层级
- [ ] **监控和日志记录**：所有关键操作
- [ ] **备份**：策略和程序

**3.3. 用户体验**
- [ ] **UI/UX**：所有用户界面
- [ ] **数据验证**：客户端和服务器端
- [ ] **通知**：所有类型的用户消息
- [ ] **帮助系统**：帮助和文档
- [ ] **可访问性**：残障人士需求

##### 4.3.3.4. 阶段4：一致性检查

**4.1. 数据不一致**
- [ ] **数据类型**：ERD和API之间的一致性
- [ ] **约束**：业务规则和数据库之间的一致性
- [ ] **格式**：日期、数字、字符串格式的统一性
- [ ] **参考数据**：参考数据的一致性

**4.2. 流程不一致**
- [ ] **顺序**：活动图 vs 序列图
- [ ] **角色和权限**：User Stories vs Use Cases vs 组件图
- [ ] **时间限制**：不同工件中的超时和SLA
- [ ] **执行条件**：前置条件和后置条件

**4.3. 架构不一致**
- [ ] **调用方向**：序列图 vs 组件图
- [ ] **协议**：架构和API之间的一致性
- [ ] **安全性**：所有组件中的统一机制
- [ ] **性能**：整个系统的一致要求

##### 4.3.3.5. 阶段5：无歧义性检查

**5.1. 术语无歧义**
- [ ] **术语表**：术语的统一理解
- [ ] **缩写**：所有缩写的解码
- [ ] **同义词**：消除重复术语
- [ ] **上下文性**：不同上下文中的相同术语

**5.2. 功能无歧义**
- [ ] **验收标准**：具体且可衡量
- [ ] **用户操作**：Use Cases中的清晰表述
- [ ] **系统行为**：确定性算法
- [ ] **异常处理**：系统的具体操作

**5.3. 技术无歧义**
- [ ] **API规范**：精确的数据类型和格式
- [ ] **图表**：标准PlantUML符号
- [ ] **配置**：清晰的调整参数
- [ ] **集成**：精确的协议和交换格式

---

#### 4.3.4. 业务需求检查（详细）

##### 4.3.4.1. User Story (AS IS 和 TO BE)

**逻辑完整性检查：**
- [ ] AS IS 在逻辑上先于 TO BE
- [ ] 角色与流程的实际参与者相对应
- [ ] 操作在问题域范围内可执行
- [ ] 结果可达成且可衡量

**完整性检查：**
- [ ] 覆盖所有用户类型
- [ ] 描述所有主要业务功能
- [ ] 考虑集成场景
- [ ] 包括管理功能

**一致性检查：**
- [ ] 角色在故事之间不冲突
- [ ] 操作不违反业务规则
- [ ] 故事之间的结果协调一致

**无歧义性检查：**
- [ ] 角色明确定义
- [ ] 操作使用具体动词描述
- [ ] 结果可定量衡量
- [ ] 使用标准表述

##### 4.3.4.2. Use Case

**结构检查：**
- [ ] 标题反映业务目标
- [ ] 参与者与User Stories相对应
- [ ] 前置条件现实可行
- [ ] 限制在技术上可实现
- [ ] 触发器具体且可观察
- [ ] 主要场景逻辑顺序
- [ ] 替代场景覆盖边缘情况
- [ ] 异常场景包括错误处理
- [ ] 成功标准可衡量

**逻辑完整性检查：**
- [ ] 场景步骤逻辑相关
- [ ] 替代流正确返回到主流
- [ ] 异常在适当级别处理
- [ ] 后置条件从前置条件可达

**追溯性检查：**
- [ ] 每个Use Case对应一个User Story
- [ ] 参与者与User Stories中的角色协调一致
- [ ] 功能覆盖TO BE中的需求

##### 4.3.4.3. 活动图

**逻辑完整性检查：**
- [ ] 泳道与Use Case中的角色相对应
- [ ] 操作顺序合乎逻辑
- [ ] 分支条件正确
- [ ] 并行进程独立
- [ ] 所有路径都导致完成

**业务流程完整性检查：**
- [ ] 覆盖Use Case中的所有步骤
- [ ] 包括验证过程
- [ ] 处理错误情况
- [ ] 考虑通知过程
- [ ] 包括审计过程

---

#### 4.3.5. 系统需求检查（详细）

##### 4.3.5.1. 架构和组件图

**架构检查：**
- [ ] 架构层清晰分离
- [ ] 依赖关系单向
- [ ] 组件间接口协调一致
- [ ] 无循环依赖

**架构完整性检查：**
- [ ] 所有功能需求由组件覆盖
- [ ] 包括安全组件
- [ ] 存在监控组件
- [ ] 考虑集成组件
- [ ] 包括配置组件

##### 4.3.5.2. 数据模型和ERD

**逻辑完整性检查：**
- [ ] 实体与业务对象相对应
- [ ] 关系反映实际关系
- [ ] 关系基数正确
- [ ] 主键唯一标识记录
- [ ] 外键维护完整性

**规范化检查：**
- [ ] 第一范式 (1NF)：值的原子性
- [ ] 第二范式 (2NF)：对完整键的依赖
- [ ] 第三范式 (3NF)：无传递依赖
- [ ] 反规范化的合理性（如有）

##### 4.3.5.3. 序列图

**逻辑完整性检查：**
- [ ] 参与者与架构组件相对应
- [ ] 调用顺序合乎逻辑
- [ ] 同步/异步调用正确
- [ ] 遵守对象生命周期
- [ ] 存在错误处理

**追溯性检查：**
- [ ] 每个图表对应一个Use Case场景
- [ ] 参与者与活动图中的角色相对应
- [ ] 交互实现业务流程

##### 4.3.5.4. REST API 和 OpenAPI

**逻辑完整性检查：**
- [ ] 资源与ERD实体相对应
- [ ] HTTP方法语义正确
- [ ] URL结构层次逻辑
- [ ] 响应代码与情况相对应
- [ ] 数据模式与模型协调一致

**API完整性检查：**
- [ ] 所有实体的CRUD操作
- [ ] 搜索和过滤操作
- [ ] 批量操作
- [ ] 健康检查和监控端点
- [ ] 管理操作

---

#### 4.3.6. 验收标准和非功能性需求（扩展）

##### 4.3.6.1. 验收标准
**逻辑完整性检查：**
- [ ] 与具体User Stories的关联
- [ ] 标准的可衡量性
- [ ] 标准的可测试性
- [ ] 标准彼此独立

**完整性检查：**
- [ ] 所有主要场景的功能标准
- [ ] 性能标准
- [ ] 安全标准
- [ ] 可用性标准
- [ ] 兼容性标准

##### 4.3.6.2. 非功能性需求

**1. 性能**
- [ ] 每种操作类型的响应时间
- [ ] 系统吞吐量
- [ ] 资源消耗（CPU、内存、磁盘）
- [ ] 可扩展性（垂直/水平）

**2. 安全性**
- [ ] 认证和授权
- [ ] 数据加密（静态和传输中）
- [ ] 审计和日志记录
- [ ] 漏洞防护（OWASP Top 10）

**3. 可靠性**
- [ ] 系统可用性（SLA）
- [ ] 容错性
- [ ] 恢复时间（RTO/RPO）
- [ ] 监控和告警

---

#### 4.3.7. 需求追溯矩阵

##### 4.3.7.1. 垂直追溯
| User Story | Use Case | Activity | Sequence | Component | ERD | API |
|------------|----------|----------|----------|-----------|-----|-----|
| US-001 | UC-001 | ACT-001 | SEQ-001 | COMP-001 | ENT-001 | API-001 |

**检查：**
- [ ] 每行完全填充
- [ ] 追溯链无中断
- [ ] 一个工件的变更反映在相关工件中

##### 4.3.7.2. 水平一致性
**角色和参与者：**
- [ ] User Stories ↔ Use Cases ↔ Activity ↔ Sequence
- [ ] 统一的角色术语
- [ ] 协调的访问权限

**数据对象：**
- [ ] Use Cases ↔ ERD ↔ API ↔ Component
- [ ] 统一的实体名称
- [ ] 协调的属性

---

#### 4.3.8. 高级分析方法

##### 4.3.8.1. 差距分析
**方法：**
1. 列出所有顶级业务流程
2. 检查需求中每个流程的覆盖情况
3. 识别缺失元素
4. 评估差距的关键性

**报告模板：**

流程：[名称]
覆盖：[完整/部分/缺失]
差距：[缺失元素列表]
关键性：[高/中/低]
建议：[添加内容]


##### 4.3.8.2. 影响分析
**方法：**
1. 为每个需求确定依赖元素
2. 评估变更的影响
3. 识别潜在冲突
4. 确定关键依赖的优先级

##### 4.3.8.3. 风险分析
**需求中的风险类型：**
- [ ] **不确定性**：模糊的表述
- [ ] **复杂性**：过度的技术复杂性
- [ ] **依赖性**：关键的外部依赖
- [ ] **性能**：无法实现的SLA
- [ ] **集成**：复杂的集成场景

---

#### 4.3.9. 高级分析师最终检查清单

##### 4.3.9.1. 结构完整性
- [ ] 所有工件根据标准存在
- [ ] 工件符合.clinerules中的说明
- [ ] 工件的版本控制和标识
- [ ] 工件之间的关系可追溯

##### 4.3.9.2. 逻辑完整性
- [ ] 垂直追溯无中断
- [ ] 水平术语一致性
- [ ] 因果关系正确
- [ ] 时间顺序合乎逻辑

##### 4.3.9.3. 覆盖完整性
- [ ] 所有业务流程被需求覆盖
- [ ] 所有用户角色被考虑
- [ ] 所有技术组件被描述
- [ ] 所有集成被指定
- [ ] 所有异常情况被处理

##### 4.3.9.4. 一致性
- [ ] 业务逻辑无冲突
- [ ] 技术组件兼容性
- [ ] 性能需求一致性
- [ ] 安全原则统一性

##### 4.3.9.5. 无歧义性
- [ ] 术语在术语表中定义
- [ ] 验收标准具体且可衡量
- [ ] 技术规范详细
- [ ] 业务规则形式化

##### 4.3.9.6. 文档质量
- [ ] 结构和导航
- [ ] 版本最新性
- [ ] 示例和图表的完整性
- [ ] 符合企业标准

---

#### 4.3.10. 高级分析师报告模板

markdown
## 需求检查报告：[项目名称]

### 执行摘要
- **总体评估**：[接受/有条件接受/拒绝]
- **关键问题**：[数量]
- **建议**：[主要行动]

### 详细分析

#### 1. 逻辑完整性：[评分/10]
- ✅ 通过：[列表]
- ❌ 问题：[带详细信息的列表]
- 💡 建议：[具体行动]

#### 2. 完整性：[评分/10]
- ✅ 通过：[列表]
- ❌ 差距：[带关键性的列表]
- 💡 建议：[添加内容]

#### 3. 一致性：[评分/10]
- ✅ 通过：[列表]
- ❌ 冲突：[带影响的列表]
- 💡 建议：[如何解决]

#### 4. 无歧义性：[评分/10]
- ✅ 通过：[列表]
- ❌ 不确定性：[带风险的列表]
- 💡 建议：[如何澄清]

### 追溯矩阵
[工件关系表]

### 风险分析
| 风险 | 概率 | 影响 | 缓解措施 |
|------|------|------|----------|

### 后续步骤
1. [优先行动]
2. [次要改进]
3. [长期建议]

### 附件
- 按工件的详细意见
- 建议的修正
- 标准和最佳实践链接


---

**遵循此扩展指南，以系统且高质量地进行高级分析师级别的需求审查，确保最高质量的架构解决方案。**

