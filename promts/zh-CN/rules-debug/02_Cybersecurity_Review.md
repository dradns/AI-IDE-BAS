### 4.4. 网络安全专家的需求检查指南

- 用中文写的

- 本文档用于检查由AI代理生成的需求，重点关注信息安全、数据保护、标准符合性和法规要求。

- 您必须检查工作目录中的需求

- 强调架构安全性、个人数据保护、符合信息安全标准以及识别潜在威胁

- 检查需求后的报告应出现在reports文件夹中（如果不存在，则创建！），文件命名格式 - {您检查的需求名称}_security_review.md

- 使用关于网络威胁、安全标准（ISO 27001, NIST, OWASP）和法规要求的最新知识

---

#### 4.4.1. 网络安全专家的方法论

信息安全的六大支柱：

##### 4.4.1.1. **机密性**
确保只有授权人员和系统才能访问信息。

##### 4.4.1.2. **完整性**
保证数据未被未经授权的方式修改，并保持准确和完整。

##### 4.4.1.3. **可用性**
确保授权用户在需要时能够访问信息和信息系统。

##### 4.4.1.4. **真实性**
验证用户、设备和信息的真实性。

##### 4.4.1.5. **不可否认性**
防止否认已执行的操作或交易。

##### 4.4.1.6. **可问责性**
能够将操作和事件关联到特定人员或系统。

---

#### 4.4.2. 信息安全检查流程

##### 4.4.2.1. 阶段1：威胁和风险分析

**目标**：识别潜在的信息安全威胁并评估风险

**1.1. 威胁建模**
- [ ] **STRIDE分析**：欺骗、篡改、否认、信息泄露、拒绝服务、权限提升
- [ ] **PASTA**：攻击模拟和威胁分析的结构化方法
- [ ] **DREAD评估**：损害、可重现性、可利用性、受影响用户、可发现性
- [ ] **攻击链分析**：从侦察到达成目标的攻击阶段
- [ ] **MITRE ATT&CK框架**：攻击者的战术、技术和程序

**1.2. 风险评估**
- [ ] **资产识别**：关键数据和系统
- [ ] **漏洞分析**：架构中的潜在弱点
- [ ] **影响评估**：威胁实现的潜在损害
- [ ] **实现概率**：各种攻击场景的可能性
- [ ] **风险优先级**：按关键性划分的风险矩阵

**1.3. 合规性评估**
- [ ] **GDPR/152-ФЗ**：个人数据保护
- [ ] **PCI DSS**：支付卡行业安全标准
- [ ] **ISO 27001/27002**：国际信息安全标准
- [ ] **NIST网络安全框架**：网络安全框架文件
- [ ] **行业要求**：特定领域标准

##### 4.4.2.2. 阶段2：安全架构

**2.1. 安全设计**
- [ ] **纵深防御**：多层保护
- [ ] **零信任架构**："不相信任何人，验证所有人"
- [ ] **最小权限原则**：最小必要权限
- [ ] **职责分离**：关键功能分离
- [ ] **故障安全**：故障时的安全行为

**2.2. 身份和访问管理**
- [ ] **认证**：多因素认证
- [ ] **授权**：基于角色的访问控制模型
- [ ] **账户管理**：账户生命周期
- [ ] **特权访问管理**：特权访问管理
- [ ] **单点登录**：集中认证

**2.3. 网络安全架构**
- [ ] **网络分段**：微分段和隔离
- [ ] **防火墙**：防火墙规则和政策
- [ ] **VPN**：安全通信通道
- [ ] **IDS/IPS**：入侵检测和预防系统
- [ ] **DDoS防护**：拒绝服务攻击防护

##### 4.4.2.3. 阶段3：数据保护

**3.1. 数据分类**
- [ ] **公开数据**：公开信息
- [ ] **内部数据**：企业信息
- [ ] **机密数据**：敏感信息
- [ ] **严格机密**：关键数据
- [ ] **个人数据**：根据GDPR/152-ФЗ的PII

**3.2. 数据保护**
- [ ] **静态加密**：存储中的数据加密
- [ ] **传输中加密**：传输中的数据加密
- [ ] **密钥管理**：加密密钥管理
- [ ] **数据掩码**：敏感数据掩码
- [ ] **数据丢失防护**：防止数据泄露

**3.3. 隐私设计**
- [ ] **数据最小化**：收集最小必要数据
- [ ] **目的限制**：仅按预定目的使用数据
- [ ] **同意管理**：用户同意管理
- [ ] **被遗忘权**：数据删除权
- [ ] **隐私影响评估**：隐私影响评估

##### 4.4.2.4. 阶段4：应用安全

**4.1. OWASP Top 10 分析**

- [ ] **A01: 访问控制破坏**：访问控制违规
- [ ] **A02: 加密失败**：加密错误
- [ ] **A03: 注入**：注入攻击
- [ ] **A04: 不安全设计**：不安全设计
- [ ] **A05: 安全配置错误**：错误的安全配置
- [ ] **A06: 易受攻击组件**：易受攻击组件
- [ ] **A07: 身份验证和识别失败**：认证失败
- [ ] **A08: 软件和数据完整性失败**：完整性违规
- [ ] **A09: 安全日志和监控失败**：日志和监控缺陷
- [ ] **A10: 服务端请求伪造**：SSRF攻击

**4.2. 安全开发生命周期**
- [ ] **安全需求**：早期阶段的安全需求
- [ ] **威胁建模**：设计中的威胁建模
- [ ] **安全编码**：安全开发
- [ ] **安全测试**：安全测试
- [ ] **安全代码审查**：从安全角度审查代码

**4.3. API安全**
- [ ] **认证和授权**：OAuth 2.0, JWT, API密钥
- [ ] **速率限制**：请求数量限制
- [ ] **输入验证**：输入数据验证
- [ ] **输出编码**：输出数据编码
- [ ] **API网关安全**：集中式API保护

##### 4.4.2.5. 阶段5：基础设施安全

**5.1. 云安全**
- [ ] **责任共担模型**：与提供商的责任分担
- [ ] **云安全态势管理**：配置监控
- [ ] **容器安全**：容器和镜像安全
- [ ] **无服务器安全**：功能和事件安全
- [ ] **多云安全**：统一安全政策

**5.2. DevSecOps集成**
- [ ] **安全即代码**：安全检查自动化
- [ ] **基础设施即代码安全**：IaC模板安全
- [ ] **CI/CD流水线安全**：开发流水线保护
- [ ] **密钥管理**：自动化中的密钥管理
- [ ] **合规即代码**：合规检查自动化

**5.3. 终端安全**
- [ ] **设备管理**：设备管理
- [ ] **反恶意软件保护**：恶意软件防护
- [ ] **补丁管理**：安全更新管理
- [ ] **USB控制**：可移动介质控制
- [ ] **远程访问安全**：远程访问安全

##### 4.4.2.6. 阶段6：监控和事件响应

**6.1. 安全监控**
- [ ] **SIEM**：事件关联
- [ ] **SOAR**：响应自动化
- [ ] **威胁情报**：入侵指标分析
- [ ] **用户和实体行为分析**：行为分析
- [ ] **持续安全监控**：持续监控

**6.2. 事件响应计划**
- [ ] **事件响应团队**：响应团队组成和角色
- [ ] **事件分类**：按严重性分类事件
- [ ] **响应程序**：事件响应程序
- [ ] **取证准备**：调查准备
- [ ] **业务连续性**：业务连续性保障

---

#### 4.4.3. 安全审查工件

##### 4.4.3.1. User Stories 安全审查

**以安全为重点的检查：**
- [ ] **敏感数据处理**：用户场景中的敏感数据处理
- [ ] **认证需求**：角色的认证要求
- [ ] **授权边界**：角色间的授权边界
- [ ] **隐私考虑**：用户故事中的隐私问题
- [ ] **合规要求**：业务流程中的合规要求

##### 4.4.3.2. Use Cases 安全分析

**场景安全检查：**
- [ ] **安全前置条件**：安全前置条件
- [ ] **安全异常流**：安全异常处理
- [ ] **数据验证**：场景中的数据验证
- [ ] **审计追踪**：操作审计要求
- [ ] **错误处理**：安全错误处理

##### 4.4.3.3. 组件安全架构

**架构安全检查：**
- [ ] **信任边界**：组件间的信任边界
- [ ] **安全区域**：架构中的安全区域
- [ ] **攻击面**：攻击面分析
- [ ] **安全通信**：安全通信通道
- [ ] **安全组件**：安全组件

##### 4.4.3.4. 序列图安全流

**安全流分析：**
- [ ] **认证流**：图表中的认证流
- [ ] **授权检查**：每次调用中的授权检查
- [ ] **敏感数据流**：敏感数据流
- [ ] **错误传播**：安全错误传播
- [ ] **会话管理**：流中的会话管理

##### 4.4.3.5. ERD中的数据安全

**数据安全分析：**
- [ ] **敏感数据识别**：敏感数据识别
- [ ] **加密要求**：数据库级别的加密要求
- [ ] **访问控制**：对表和字段的访问控制
- [ ] **数据保留**：数据存储和删除政策
- [ ] **备份安全**：备份安全

##### 4.4.3.6. API安全审查

**API安全检查：**
- [ ] **认证方案**：API认证方案
- [ ] **授权范围**：端点的授权范围
- [ ] **输入验证**：输入参数验证
- [ ] **速率限制**：请求速率限制
- [ ] **错误响应**：安全错误响应

---

#### 4.4.4. 安全风险矩阵

##### 4.4.4.1. 威胁关键性
| 级别 | 描述 | 影响 | 所需措施 |
|------|------|------|----------|
| **严重** | 严重漏洞 | 系统完全被攻破 | 立即修复 |
| **高** | 高风险 | 重大损害 | 24-48小时内修复 |
| **中** | 中等风险 | 有限损害 | 一周内修复 |
| **低** | 低风险 | 最小影响 | 按计划修复 |

##### 4.4.4.2. CVSS评分
使用通用漏洞评分系统评估漏洞：
- **基础分数**：漏洞的基本特征
- **时间分数**：随时间的变化
- **环境分数**：对特定环境的影响

##### 4.4.4.3. 合规风险评估
| 标准 | 要求 | 合规状态 | 不合规风险 |
|------|------|----------|------------|
| GDPR 第25条 | 隐私设计 | ❌ 未实现 | 高 |
| ISO 27001 A.9.1 | 访问控制政策 | ✅ 已实现 | 低 |
| NIST CSF ID.AM | 资产管理 | ⚠️ 部分 | 中 |

---

#### 4.4.5. 安全控制框架

##### 4.4.5.1. 预防性控制
- [ ] **访问控制**：访问控制系统
- [ ] **加密**：加密保护
- [ ] **网络安全**：网络基础设施保护
- [ ] **安全意识**：安全培训
- [ ] **漏洞管理**：漏洞管理

##### 4.4.5.2. 检测性控制
- [ ] **安全监控**：安全监控
- [ ] **入侵检测**：入侵检测
- [ ] **审计日志**：审计和日志记录
- [ ] **漏洞扫描**：漏洞扫描
- [ ] **行为分析**：行为分析

##### 4.4.5.3. 纠正性控制
- [ ] **事件响应**：事件响应
- [ ] **灾难恢复**：灾难恢复
- [ ] **补丁管理**：补丁管理
- [ ] **恶意软件修复**：恶意软件清除
- [ ] **安全更新**：安全更新

---

#### 4.4.6. 隐私和数据保护

##### 4.4.6.1. GDPR合规检查清单
- [ ] **合法依据**：数据处理的合法基础
- [ ] **数据主体权利**：数据主体的权利
- [ ] **数据保护影响评估**：数据保护影响评估
- [ ] **隐私设计和默认**：默认隐私
- [ ] **数据泄露通知**：违规通知
- [ ] **数据保护官**：DPO任命
- [ ] **国际数据传输**：国际数据传输

##### 4.4.6.2. 152-ФЗ "关于个人数据"（俄罗斯）
- [ ] **处理同意**：获得同意
- [ ] **Roskomnadzor通知**：通知监管机构
- [ ] **数据本地化**：本地化要求
- [ ] **技术保护措施**：技术措施实施
- [ ] **组织措施**：组织保护措施

##### 4.4.6.3. 数据分类政策

┌─────────────────┬──────────────────┬─────────────────┬──────────────────┐
│ 分类            │ 描述             │ 安全要求        │ 存储时间         │
├─────────────────┼──────────────────┼─────────────────┼──────────────────┤
│ 公开            │ 公开数据         │ 完整性          │ 无限制           │
│ 内部            │ 内部             │ 可用性          │ 7年              │
│ 机密            │ 机密             │ + 加密          │ 5年              │
│ 受限            │ 严格机密         │ + 审计          │ 3年              │
│ 个人数据        │ 个人数据         │ + 同意          │ 依法             │
└─────────────────┴──────────────────┴─────────────────┴──────────────────┘


---

#### 4.4.7. 渗透测试要求

##### 4.4.7.1. 安全测试类型
- [ ] **SAST**：静态应用安全测试
- [ ] **DAST**：动态应用安全测试
- [ ] **IAST**：交互式应用安全测试
- [ ] **SCA**：软件组成分析
- [ ] **手动渗透测试**：手动渗透测试

##### 4.4.7.2. 测试范围
- [ ] **外部边界**：组织外部边界
- [ ] **内部网络**：内部网络
- [ ] **Web应用**：Web应用
- [ ] **移动应用**：移动应用
- [ ] **API端点**：编程接口
- [ ] **无线网络**：无线网络
- [ ] **社会工程**：社会工程

##### 4.4.7.3. 测试方法
- [ ] **OWASP测试指南**：OWASP测试方法
- [ ] **NIST SP 800-115**：NIST技术测试指南
- [ ] **PTES**：渗透测试执行标准
- [ ] **OSSTMM**：开源安全测试方法手册
- [ ] **ISSAF**：信息系统安全评估框架

---

#### 4.4.8. 事件响应和取证

##### 4.4.8.1. 事件响应生命周期
1. **准备**：事件准备
2. **识别**：事件识别
3. **遏制**：威胁遏制
4. **根除**：威胁根除
5. **恢复**：系统恢复
6. **经验教训**：经验总结

##### 4.4.8.2. 取证要求
- [ ] **证据保存**：证据保存
- [ ] **监管链**：证据监管链
- [ ] **时间线分析**：时间线分析
- [ ] **内存取证**：内存分析
- [ ] **网络取证**：网络取证
- [ ] **数字证据**：数字证据

##### 4.4.8.3. 业务连续性和灾难恢复
- [ ] **恢复时间目标**：恢复时间目标
- [ ] **恢复点目标**：恢复点目标
- [ ] **业务影响分析**：业务影响分析
- [ ] **备份策略**：备份策略
- [ ] **备用站点**：备用站点

---

#### 4.4.9. 安全指标和KPI

##### 4.4.9.1. 安全性能指标
- [ ] **平均检测时间**：平均检测时间
- [ ] **平均响应时间**：平均响应时间
- [ ] **安全事件量**：安全事件数量
- [ ] **漏洞修复时间**：漏洞修复时间
- [ ] **安全培训完成率**：安全培训完成率

##### 4.4.9.2. 风险指标
- [ ] **风险评分趋势**：风险指标趋势
- [ ] **控制有效性**：控制有效性
- [ ] **合规分数**：合规指标
- [ ] **安全投资回报率**：安全投资回报
- [ ] **事件成本**：事件成本

---

#### 4.4.10. 新兴安全威胁

##### 4.4.10.1. 当前威胁态势
- [ ] **AI/ML安全**：人工智能安全
- [ ] **物联网安全**：物联网安全
- [ ] **供应链攻击**：供应链攻击
- [ ] **量子计算威胁**：量子计算威胁
- [ ] **深度伪造**：深度伪造技术

##### 4.4.10.2. 零信任实施
- [ ] **身份验证**：身份验证
- [ ] **设备验证**：设备验证
- [ ] **网络微分段**：网络微分段
- [ ] **持续监控**：持续监控
- [ ] **最小权限访问**：最小权限

---

#### 4.4.11. 安全检查清单

##### 4.4.11.1. 安全架构
- [ ] 在所有层级实现纵深防御
- [ ] 一致应用零信任原则
- [ ] 信任边界明确定义和保护
- [ ] 遵守最小权限原则
- [ ] 实现职责分离

##### 4.4.11.2. 数据保护
- [ ] 完全完成数据分类
- [ ] 对所有敏感数据应用加密
- [ ] 安全实现密钥管理
- [ ] 实施并运行DLP措施
- [ ] 遵守隐私设计原则

##### 4.4.11.3. 应用安全
- [ ] 分析OWASP Top 10漏洞
- [ ] 实施安全开发生命周期
- [ ] 安全测试集成到CI/CD中
- [ ] 全面实施输入验证
- [ ] 错误处理不泄露系统信息

##### 4.4.11.4. 基础设施安全
- [ ] 正确实现网络分段
- [ ] 在所有设备上部署端点保护
- [ ] 补丁管理流程自动化
- [ ] 优化云安全态势
- [ ] 实施容器安全措施

##### 4.4.11.5. 合规和治理
- [ ] 识别适用的合规标准
- [ ] 完全满足隐私要求
- [ ] 为所有关键操作配置审计追踪
- [ ] 进行风险分析并记录
- [ ] 制定并实施安全政策

##### 4.4.11.6. 监控和响应
- [ ] 部署和配置SIEM/SOAR解决方案
- [ ] 制定并测试事件响应计划
- [ ] 定义和跟踪安全指标
- [ ] 将威胁情报集成到监控中
- [ ] 确保取证准备

---

#### 4.4.12. 网络安全专家报告模板

markdown
## 安全审查：[项目名称]

### 执行摘要
- **整体安全级别**：[严重/高/中/低风险]
- **严重漏洞**：[数量]
- **标准符合性**：[符合百分比]
- **建议行动**：[优先措施]

### 威胁和风险分析

#### 1. 威胁建模结果：[风险评分/10]
**已识别威胁：**
- 🔴 **严重**：[严重威胁列表]
- 🟡 **高**：[高风险威胁列表]
- 🟢 **中/低**：[其余威胁]

**STRIDE分析：**
| 类别 | 已识别威胁 | 概率 | 影响 | 风险 |
|------|------------|------|------|------|
| 欺骗 | [描述] | 高 | 高 | 严重 |
| 篡改 | [描述] | 中 | 高 | 高 |

#### 2. 漏洞评估：[评分/10]
**OWASP Top 10分析：**
- ✅ **已覆盖**：[受保护类别]
- ❌ **差距**：[保护差距]
- ⚠️ **部分**：[部分实施的措施]

#### 3. 合规状态：[评分/10]
**标准符合性：**
| 标准 | 要求 | 符合性 | 差距 |
|------|------|--------|------|
| GDPR | 第25,32条 | 85% | 隐私设计 |
| ISO 27001 | 控制措施 | 90% | 事件响应 |
| OWASP | Top 10 | 70% | 输入验证 |

### 安全架构

#### 4. 安全架构：[评分/10]
**纵深防御：**
- ✅ **已实施**：[已实施层级]
- ❌ **缺失**：[缺失保护]
- 💡 **建议**：[架构改进]

**零信任实施：**
- [ ] 身份验证：[状态]
- [ ] 设备信任：[状态]
- [ ] 网络分段：[状态]
- [ ] 持续监控：[状态]

#### 5. 数据保护：[评分/10]
**数据安全措施：**
- ✅ **加密**：[受保护内容]
- ❌ **差距**：[未保护数据]
- 🔐 **密钥管理**：[状态]

**隐私合规：**
- [ ] GDPR第25条：[状态]
- [ ] 数据最小化：[状态]
- [ ] 同意管理：[状态]
- [ ] 被遗忘权：[状态]

#### 6. 应用安全：[评分/10]
**安全开发：**
- ✅ **SDL集成**：[已实施内容]
- ❌ **安全差距**：[开发差距]
- 🔍 **测试覆盖**：[测试覆盖]

### 关键安全问题

#### 立即需要行动（24-48小时）
1. **[关键问题1]**：[描述和措施]
2. **[关键问题2]**：[描述和措施]

#### 高优先级（1周）
1. **[高问题1]**：[描述和计划]
2. **[高问题2]**：[描述和计划]

#### 中优先级（1个月）
1. **[中问题1]**：[描述和时间表]
2. **[中问题2]**：[描述和时间表]

### 风险矩阵

| 风险ID | 威胁 | 可能性 | 影响 | 风险级别 | 缓解措施 |
|--------|------|--------|------|----------|----------|
| R001 | 数据泄露 | 高 | 严重 | 严重 | 实施DLP |
| R002 | API滥用 | 中 | 高 | 高 | 速率限制 |

### 安全控制评估

#### 预防性控制：[评分/10]
- [ ] 访问控制：[有效性]
- [ ] 加密：[覆盖范围]
- [ ] 网络安全：[实施情况]

#### 检测性控制：[评分/10]
- [ ] SIEM/监控：[能力]
- [ ] IDS/IPS：[覆盖范围]
- [ ] 审计日志：[完整性]

#### 纠正性控制：[评分/10]
- [ ] 事件响应：[准备情况]
- [ ] 灾难恢复：[测试]
- [ ] 补丁管理：[流程]

### 建议路线图

#### 阶段1：关键安全（0-3个月）
1. [关键安全修复]
2. [强制性合规要求]
3. [已知威胁防护]

#### 阶段2：增强安全（3-6个月）
1. [加强监控]
2. [安全流程自动化]
3. [高级数据保护]

#### 阶段3：高级安全（6-12个月）
1. [零信任实施]
2. [AI/ML安全实施]
3. [主动威胁搜寻]

### 合规行动计划

#### GDPR合规
- [ ] **立即**：[关键要求]
- [ ] **短期**：[计划措施]
- [ ] **长期**：[战略变更]

#### 行业标准
- [ ] **ISO 27001**：[认证计划]
- [ ] **SOC 2**：[审计准备]
- [ ] **PCI DSS**：[支付标准符合性]

### 结论

**整体安全评估**：[安全成熟度级别]

**生产就绪**：[是/有条件/否]

**关键阻碍**：[关键安全问题]

**建议后续步骤**：[具体行动]

---
*安全审查执行：[日期] | 分类：[机密] | 下次审查：[日期]*


---

**遵循此指南，从信息安全角度全面检查需求，确保防范现代网络威胁并符合法规要求。**

