### 4.8. 非功能性需求

**非功能性需求 (NFR) 模板**

#### 4.8.1. 内容
1. [引言](#引言)
2. [NFR 结构](#nfr-结构)
3. [主要 NFR 类别](#主要-nfr-类别)
4. [按类别划分的模板](#按类别划分的模板)
5. [指标与测量](#指标与测量)
6. [工具与方法](#工具与方法)
7. [检查清单](#检查清单)
8. [填写示例](#填写示例)

#### 4.8.2. 引言

非功能性需求 (NFR) 定义了影响系统性能、安全性、可靠性和可用性的定性特征。与功能性需求不同，NFR 描述的不是系统*做什么*，而是*如何*做。

##### 高质量 NFR 的关键特征：
1.  **可测量性** - 具体的数值指标
2.  **可测试性** - 客观验证
3.  **现实性** - 在项目范围内可实现
4.  **优先级** - 定义的优先级
5.  **合理性** - 对业务的重要性

#### 4.8.3. NFR 结构

##### 4.8.3.1. 强制性元素：
1.  **唯一标识符** - 格式：NFR-XXX
2.  **类别名称** - 需求类型（性能、安全等）
3.  **描述** - 系统必须提供什么的清晰描述
4.  **测量标准** - 带有测量单位的具体可测量指标
5.  **优先级** - 关键/高/中/低
6.  **理由** - 对业务的重要性

##### 4.8.3.2. 通用 NFR 模板：

NFR-XXX: [需求名称]
描述: [系统必须提供什么的清晰描述]
测量标准:
- [标准 1，包含具体值和测量单位]
- [标准 2，包含具体值和测量单位]
- [测量和测试条件]
优先级: [关键/高/中/低]
理由: [为什么此需求对业务很重要]


#### 4.8.4. 主要 NFR 类别

##### 4.8.4.1. 性能 (Performance)
- **响应时间**：在多达 1000 个用户的负载下不超过 2 秒
- **吞吐量**：每秒至少 500 个事务
- **资源使用率**：CPU 不超过 70%，内存不超过 2 GB

##### 4.8.4.2. 安全 (Security)
- **身份验证**：多因素，5 次失败尝试后锁定
- **数据保护**：AES-256 加密，TLS 1.3
- **授权**：对每个请求进行角色检查

##### 4.8.4.3. 可靠性 (Reliability)
- **可用性**：每月至少 99.9%
- **恢复时间**：故障后不超过 15 分钟
- **容错性**：关键组件的冗余

##### 4.8.4.4. 可扩展性 (Scalability)
- **水平扩展**：添加服务器时线性增长
- **垂直扩展**：增加资源带来性能的成比例提升
- **自动扩展**：根据负载情况

##### 4.8.4.5. 可用性 (Usability)
- **学习时间**：新用户不超过 2 小时
- **点击次数**：主要操作不超过 3 次
- **无障碍性**：符合 WCAG 2.1 AA 标准

##### 4.8.4.6. 兼容性 (Compatibility)
- **浏览器**：Chrome 90+、Firefox 88+、Safari 14+、Edge 90+
- **集成**：REST API、JSON/XML、SSO
- **平台**：Windows Server 2019+、Linux Ubuntu 20.04+

##### 4.8.4.7. 可移植性 (Portability)
- **跨平台**：Windows、Linux、Docker、Kubernetes
- **云部署**：AWS、Azure、GCP

##### 4.8.4.8. 可维护性 (Maintainability)
- **模块化**：清晰的组件边界
- **文档**：API 文档，测试覆盖率至少 80%
- **部署**：新版本部署不超过 30 分钟

#### 4.8.5. 按类别划分的模板

##### 4.8.5.1. 性能 (Performance)

###### 4.8.5.1.1. 性能 NFR 模板：

NFR-PERF-XXX: [性能需求名称]
描述: [所需系统性能的描述]
测量标准:
- 响应时间: [值] [单位] 在 [负载条件] 下
- 吞吐量: [值] [单位]
- 资源使用率: CPU 不超过 [%]，内存不超过 [GB]
- 页面加载时间: 不超过 [秒]
测量条件:
- 环境: [测试环境特征]
- 负载: [用户数/请求数]
- 持续时间: [测试时间]
工具: [测量工具列表]
优先级: [关键/高/中/低]
理由: [对业务的重要性]


###### 4.8.5.1.2. 性能 NFR 示例：

NFR-PERF-001: 产品搜索性能
描述: 产品搜索系统必须能在高负载下提供快速响应
测量标准:
- 搜索时间: 在 1000 个并发请求下不超过 1 秒
- 吞吐量: 每秒 2000 个搜索查询
- 结果加载时间: 不超过 500 毫秒（第 95 百分位数）
- CPU 使用率: 在峰值负载下不超过 60%
测量条件:
- 环境: 8 CPU, 16 GB RAM, SSD, 100 Mbps 网络
- 负载: 1000 个并发用户
- 数据: 1,000,000 个产品, 10,000 个类别
工具: Apache JMeter, Gatling, Prometheus
优先级: 关键
理由: 搜索速度对销售转化率至关重要


##### 4.8.5.2. 安全 (Security)

###### 4.8.5.2.1. 安全 NFR 模板：

NFR-SEC-XXX: [安全需求名称]
描述: [所需安全措施的描述]
测量标准:
- 身份验证: [方法和参数]
- 授权: [访问控制机制]
- 数据保护: [加密和保护方法]
- 审计: [日志记录和监控]
测试条件:
- 场景: [测试场景列表]
- 工具: [安全测试工具]
- 标准: [符合的标准]
优先级: [关键/高/中/低]
理由: [对业务的重要性]


###### 4.8.5.2.2. 安全 NFR 示例：

NFR-SEC-001: 用户身份验证
描述: 系统必须提供安全的用户身份验证
测量标准:
- 多因素身份验证: 管理员必须使用
- 账户锁定: 5 次失败尝试后锁定 30 分钟
- 密码复杂度: 至少 8 个字符，字母+数字+特殊字符
- 会话时间: 不活动时间不超过 8 小时
- 密码加密: 使用 salt 的 bcrypt，至少 12 轮
测试条件:
- 场景: 暴力攻击，密码破解，SQL 注入
- 工具: OWASP ZAP, Burp Suite, Metasploit
- 标准: OWASP Top 10, NIST Cybersecurity Framework
优先级: 关键
理由: 保护用户个人数据


##### 4.8.5.3. 可靠性 (Reliability)

###### 4.8.5.3.1. 可靠性 NFR 模板：

NFR-REL-XXX: [可靠性需求名称]
描述: [所需系统可靠性的描述]
测量标准:
- 可用性: [时间段] 内的 [正常运行时间百分比]
- 恢复时间 (MTTR): 不超过 [时间]
- 平均无故障时间 (MTBF): 至少 [时间]
- 容错性: [机制描述]
测试条件:
- 故障场景: [测试场景列表]
- 恢复计划: [恢复程序]
- 监控: [指标和警报]
优先级: [关键/高/中/低]
理由: [对业务的重要性]


###### 4.8.5.3.2. 可靠性 NFR 示例：

NFR-REL-001: 系统可用性
描述: 系统必须为用户提供高可用性
测量标准:
- 可用性: 每月至少 99.9%（最多停机 43 分钟）
- 恢复时间 (MTTR): 故障后不超过 15 分钟
- 平均无故障时间 (MTBF): 至少 720 小时（30 天）
- 计划内维护: 每月在非工作时间不超过 4 小时
- 监控: 24/7，当不可用超过 1 分钟时发出警报
测试条件:
- 场景: 服务器故障，数据库故障，网络故障
- 恢复计划: 自动故障转移，备份
- 监控: Pingdom, New Relic, 自定义健康检查
优先级: 关键
理由: 系统不可用会导致销售损失


##### 4.8.5.4. 可扩展性 (Scalability)

###### 4.8.5.4.1. 可扩展性 NFR 模板：

NFR-SCAL-XXX: [可扩展性需求名称]
描述: [所需系统可扩展性的描述]
测量标准:
- 水平可扩展性: [节点数] 具有 [效率]
- 垂直可扩展性: [资源增加] 带来 [性能提升]
- 自动扩展: [条件和边界]
- 扩展时的性能: [指标]
测试条件:
- 负载场景: [扩展测试场景]
- 架构决策: [架构描述]
- 监控: [扩展指标]
优先级: [关键/高/中/低]
理由: [对业务的重要性]


###### 4.8.5.4.2. 可扩展性 NFR 示例：

NFR-SCAL-001: Web 服务器水平可扩展性
描述: 系统在添加服务器时必须能线性扩展
测量标准:
- 线性扩展: 服务器数量翻倍带来 1.8-2.0 倍的性能提升
- 最大服务器数量: 集群中最多 20 台服务器
- 自动扩展: 当 CPU > 70% 超过 5 分钟时添加服务器
- 服务器移除: 当 CPU < 30% 超过 10 分钟时
- 负载均衡: 均匀分布，偏差不超过 10%
测试条件:
- 场景: 逐渐增加负载，峰值负载
- 架构: 无状态应用，共享数据库，负载均衡器
- 监控: CPU, 内存, 服务器数量, 响应时间
优先级: 高
理由: 支持用户增长而不降低性能


##### 4.8.5.5. 可用性 (Usability)

###### 4.8.5.5.1. 可用性 NFR 模板：

NFR-USAB-XXX: [可用性需求名称]
描述: [所需可用性的描述]
测量标准:
- 学习时间: 对于 [用户类型] 不超过 [时间]
- 点击次数: 对于 [操作] 不超过 [次数]
- 无障碍性: 符合 [标准] 级别 [级别]
- 导航便利性: [导航指标]
测试条件:
- 用户: [测试用户类型]
- 场景: [使用测试场景]
- 工具: [UX 测试工具]
优先级: [关键/高/中/低]
理由: [对业务的重要性]


###### 4.8.5.5.2. 可用性 NFR 示例：

NFR-USAB-001: 产品搜索可用性
描述: 产品搜索必须直观且快速
测量标准:
- 搜索时间: 从主页到结果不超过 3 次点击
- 自动补全: 输入 2 个字符后显示建议
- 过滤器: 页面上不超过 5 个主要过滤器
- 排序: 至少 3 种排序选项（价格、受欢迎程度、新颖性）
- 移动版本: 针对 320px 及以上屏幕的自适应设计
- 无障碍性: 符合 WCAG 2.1 AA
测试条件:
- 用户: 20 名不同年龄和经验的用户
- 场景: 按名称、类别、过滤器搜索
- 工具: UserTesting, Hotjar, Google Analytics
优先级: 高
理由: 搜索便利性影响转化率


##### 4.8.5.6. 兼容性 (Compatibility)

###### 4.8.5.6.1. 兼容性 NFR 模板：

NFR-COMP-XXX: [兼容性需求名称]
描述: [所需兼容性的描述]
测量标准:
- 浏览器兼容性: [浏览器和版本列表]
- 平台兼容性: [操作系统]
- 集成兼容性: [API 和协议]
- 向后兼容性: [版本和迁移]
测试条件:
- 测试环境: [测试环境列表]
- 工具: [兼容性测试工具]
- 自动化: [自动化兼容性测试]
优先级: [关键/高/中/低]
理由: [对业务的重要性]


###### 4.8.5.6.2. 兼容性 NFR 示例：

NFR-COMP-001: 浏览器兼容性
描述: Web 界面必须在所有现代浏览器中工作
测量标准:
- Chrome: 90+ 版本（支持 95% 的用户）
- Firefox: 88+ 版本（支持 90% 的用户）
- Safari: macOS 和 iOS 上的 14+ 版本（支持 85% 的用户）
- Edge: 90+ 版本（支持 80% 的用户）
- 功能性: 100% 的功能在所有支持的浏览器中工作
- 性能: 浏览器间的页面加载时间偏差不超过 20%
- 响应式设计: 在 320px-1920px 的屏幕上正确显示
测试条件:
- 环境: BrowserStack, Sauce Labs, 真实设备
- 工具: Selenium, Playwright, 浏览器开发工具
- 自动化: CI/CD 中的跨浏览器测试
优先级: 高
理由: 覆盖最大用户受众


##### 4.8.5.7. 可移植性 (Portability)

###### 4.8.5.7.1. 可移植性 NFR 模板：

NFR-PORT-XXX: [可移植性需求名称]
描述: [所需系统可移植性的描述]
测量标准:
- 跨平台: [支持的平台列表]
- 云可移植性: [支持的云提供商]
- 容器化: [容器化要求]
- 部署: [部署时间和程序]
测试条件:
- 部署环境: [测试环境列表]
- 工具: [可移植性测试工具]
- 自动化: [自动化部署程序]
优先级: [关键/高/中/低]
理由: [对业务的重要性]


###### 4.8.5.7.2. 可移植性 NFR 示例：

NFR-PORT-001: 云可移植性
描述: 系统必须可在云提供商之间移植
测量标准:
- 支持的提供商: AWS, Azure, GCP, DigitalOcean
- 容器化: 所有组件的 Docker 容器
- 编排: 用于容器管理的 Kubernetes
- 基础设施即代码: 所有云资源的 Terraform
- 部署时间: 到新环境不超过 30 分钟
- 配置: 所有设置的环境变量
- 数据库: 支持 PostgreSQL, MySQL, MongoDB
测试条件:
- 环境: 在所有支持的提供商上进行测试
- 工具: Terraform, Docker, Kubernetes, Helm
- 自动化: 所有提供商的 CI/CD 流水线
优先级: 中
理由: 在选择云提供商时的灵活性


##### 4.8.5.8. 可维护性 (Maintainability)

###### 4.8.5.8.1. 可维护性 NFR 模板：

NFR-MAINT-XXX: [可维护性需求名称]
描述: [所需系统可维护性的描述]
测量标准:
- 模块化: [模块结构和边界]
- 文档: [文档要求]
- 测试: [测试覆盖率和类型]
- 部署: [更新时间和程序]
测试条件:
- 代码质量指标: [工具和阈值]
- 程序: [支持和更新程序]
- 监控: [可维护性指标]
优先级: [关键/高/中/低]
理由: [对业务的重要性]


###### 4.8.5.8.2. 可维护性 NFR 示例：

NFR-MAINT-001: 代码质量和测试
描述: 代码必须高质量且经过良好测试
测量标准:
- 测试覆盖率: 单元测试至少 80%，集成测试至少 60%
- 代码质量: SonarQube 得分至少 A（0 技术债务）
- 文档: 每个模块的 README，API 文档
- 模块化: 组件间边界清晰，低耦合
- 编码标准: JavaScript 用 ESLint/Prettier，Python 用 Pylint
- 构建时间: 完整构建不超过 10 分钟
- 测试时间: 所有测试不超过 15 分钟
测试条件:
- 指标: SonarQube, Jest 覆盖率, ESLint
- 程序: 代码审查，结对编程，自动化测试
- 监控: 定期的代码质量报告
优先级: 高
理由: 代码质量影响开发速度


#### 4.8.6. 指标与测量

##### 4.8.6.1. 描述指标的规则

###### ✅ 正确：

- 加载时间：在多达 1000 个用户的负载下不超过 2 秒
- 可用性：每月至少 99.9%
- 吞吐量：每秒 1000 个请求
- 安全性：5 次失败尝试后锁定 30 分钟


###### ❌ 不正确：

- 加载时间：快速
- 可用性：高
- 吞吐量：许多请求
- 安全性：安全的系统


##### 4.8.6.2. 测试条件

测量条件：
- 环境：类生产环境（8 CPU, 16 GB RAM, SSD）
- 负载：1000 个并发用户
- 持续时间：1 小时
- 数据：100,000 条记录
- 网络：100 Mbps，延迟 50 毫秒


#### 4.8.7. 工具与方法

##### 4.8.7.1. 按类别划分的关键工具：
- **性能**：Apache JMeter, Lighthouse, New Relic
- **安全**：OWASP ZAP, SonarQube, Burp Suite
- **可靠性**：Nagios, Zabbix, Prometheus
- **可用性**：Google Analytics, Hotjar, UserTesting

##### 4.8.7.2. 测量方法：
- **负载测试**：Apache JMeter, Gatling
- **监控**：Prometheus + Grafana, New Relic
- **安全分析**：OWASP ZAP, Nessus
- **可用性测试**：A/B 测试，会话记录

#### 4.8.8. 检查清单

##### 4.8.8.1. 通用 NFR 检查清单：
- [ ] 需求可测量且可测试
- [ ] 指定了带有测量单位的具体数值
- [ ] 定义了需求优先级
- [ ] 需求不与其他 NFR 冲突
- [ ] 需求对项目是现实的
- [ ] 提供了对业务重要性的理由
- [ ] 定义了测量和测试条件
- [ ] 指定了测量工具

##### 4.8.8.2. 按类别划分的检查清单：

###### 4.8.8.2.1. 性能
- [ ] 指定了目标和阈值响应时间值
- [ ] 描述了负载和测试条件
- [ ] 提供了测量工具

###### 4.8.8.2.2. 安全
- [ ] 描述了保护方法和工具
- [ ] 指定了标准和合规性
- [ ] 提供了测试场景

###### 4.8.8.2.3. 可靠性
- [ ] 指定了可用性和恢复指标
- [ ] 描述了冗余计划
- [ ] 提供了故障场景

###### 4.8.8.2.4. 可扩展性
- [ ] 描述了扩展策略
- [ ] 指定了阈值
- [ ] 提供了架构决策

##### 4.8.8.3. 常见错误：
1.  **不确定的表述**："快速" 而不是 "不超过 2 秒"
2.  **缺少测量单位**："1000 用户" 而不是 "1000 个并发用户"
3.  **不切实际的需求**："10 毫秒" 而不是 "100 毫秒"
4.  **缺少理由**：NFR 未指明对业务的重要性
5.  **矛盾的需求**：相互矛盾的 NFR

##### 4.8.8.4. 实用建议：
- 为每个 NFR 包含测量方法和工具
- 指定测试条件和环境
- 定义阈值和降级场景
- 记录冲突和妥协
- 使用版本控制和变更管理
- 将 NFR 与架构决策联系起来
- 定期更新文档

#### 4.8.9. 填写示例

##### 4.8.9.1. 示例 1：电子商务 Web 应用程序


NFR-PERF-001: 主页性能
描述: 主页必须为所有用户快速加载
测量标准:
- 加载时间: 在多达 1000 个用户的负载下不超过 2 秒
- 页面大小: 不超过 2 MB
- HTTP 请求数: 不超过 50
- 操作响应时间: 不超过 1 秒（第 95 百分位数）
测量条件:
- 环境: 4 CPU, 8 GB RAM, 100 Mbps 网络
- 浏览器: Chrome 90+
- 缓存: 禁用
工具: Lighthouse, WebPageTest, Apache JMeter
优先级: 高
理由: 加载速度影响跳出率和转化率



NFR-SEC-001: 个人数据保护
描述: 系统必须确保用户个人数据的安全
测量标准:
- 数据加密: 静态数据使用 AES-256，传输中数据使用 TLS 1.3
- 身份验证: 管理员使用多因素，用户使用双因素 (2FA)
- 账户锁定: 5 次失败尝试后锁定 30 分钟
- 审计: 记录所有个人数据操作
- 合规性: GDPR，支付数据符合 PCI DSS
测试条件:
- 场景: 渗透测试，漏洞评估
- 工具: OWASP ZAP, Burp Suite, Nessus
- 标准: OWASP Top 10, NIST Cybersecurity Framework
优先级: 关键
理由: 符合监管要求和保护声誉


##### 4.8.9.2. 示例 2：移动应用程序


NFR-USAB-001: 移动应用程序可用性
描述: 移动应用程序必须对用户直观易懂
测量标准:
- 学习时间: 新用户不超过 30 分钟
- 步骤数: 主要操作不超过 3 步
- 按钮大小: 至少 44x44 像素以便轻松点击
- 手势支持: 滑动，捏合缩放，长按
- 离线模式: 主要功能在没有互联网的情况下工作
- 无障碍性: 符合 WCAG 2.1 AA
测试条件:
- 设备: iOS 14+, Android 10+, 各种屏幕尺寸
- 用户: 与真实用户一起测试
- 工具: Firebase Analytics, Crashlytics, UserTesting
优先级: 高
理由: 可用性对用户留存至关重要



NFR-COMP-001: 移动平台兼容性
描述: 应用程序必须在所有支持的移动平台上运行
测量标准:
- iOS: 14+ 版本（支持 95% 的 iOS 用户）
- Android: 10+ 版本（支持 90% 的 Android 用户）
- 屏幕尺寸: 宽度从 320px 到 428px
- 像素密度: 从 1x 到 3x
- 方向: 纵向和横向
- 性能: 平台间的响应时间偏差不超过 15%
测试条件:
- 设备: 真实设备和模拟器
- 工具: Firebase Test Lab, Appium, XCTest
- 自动化: CI/CD 中的跨平台测试
优先级: 高
理由: 覆盖最大移动用户受众


##### 4.8.9.3. 示例 3：API 服务


NFR-PERF-002: REST API 性能
描述: REST API 必须提供高吞吐量
测量标准:
- 响应时间: 不超过 200 毫秒（第 99 百分位数）
- 吞吐量: 每秒 5000 个请求
- 延迟: 正常负载下不超过 50 毫秒
- 速率限制: 每个 API 密钥每分钟 1000 个请求
- 缓存: 频繁请求数据的 TTL 为 5 分钟
测量条件:
- 环境: 4 CPU, 8 GB RAM, 1 Gbps 网络
- 负载: 1000 RPS 持续 1 小时
- 数据: 数据库中有 1,000,000 条记录
工具: Artillery, k6, New Relic, Prometheus
优先级: 高
理由: API 被移动应用程序和合作伙伴使用



NFR-SCAL-002: API 可扩展性
描述: API 必须能够扩展以支持负载增长
测量标准:
- 水平扩展: 线性增加至 20 台服务器
- 自动扩展: 当 CPU > 70% 时添加服务器
- 负载均衡: 均匀分布，偏差不超过 5%
- 数据库: 用于读取的只读副本 (read replicas)，连接池 (connection pooling)
- 缓存: 用于分布式缓存的 Redis 集群
测试条件:
- 场景: 逐渐增加负载，压力测试
- 架构: 微服务，API 网关，服务网格 (service mesh)
- 监控: 性能和扩展指标
优先级: 高
理由: 支持用户和合作伙伴集成的增长


使用这些示例作为创建高质量非功能性需求的基准。