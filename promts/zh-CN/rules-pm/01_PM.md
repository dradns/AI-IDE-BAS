### 2. 主要内容
#### 2.1 基于SA工件的角色论证和工作量估算
示例：
对于"支付模块"功能 (payment_backend.md)

| 角色      | 为什么需要？                                                                  | 故事点 (最小-最大) | 工件链接                          |
|-----------|------------------------------------------------------------------------------------|--------------|---------------------------------------------|
| Backend   | 实现复杂的转账逻辑，包括验证、交易和集成 | 8-13 SP      | payment_backend.md#logic, payment_openAPI.yaml |
| Frontend  | 开发支付表单UI（包括字段验证）                    | 3-5 SP       | payment_sequence.plantuml#ui-flow           |
| QA        | 测试20+个场景（成功/错误/边界情况）                            | 5-8 SP       | payment_backend.md#validation, *_nfr.md#test-cases |
| DevOps    | 设置交易监控和告警                                     | 3-5 SP       | *_nfr.md#monitoring                         |
| Security  | 支付数据安全审计 (PCI DSS)                                           | 2-3 SP       | *_nfr.md#security                           |

估算方法：
* 1 SP = 中级专家1天工作量
* 范围：min（理想条件）- max（考虑风险）
#### 2.2 任务制定
示例：

```markdown
TASK-101: 支付核心实现  
**角色**: Backend (8 SP)  
**工件**:  
- 需求: `payment_backend.md#core-logic`  
- API: `payment_openAPI.yaml#paths:/transfer`  
**验收标准**:  
- [ ] 交易支持 (commit/rollback)  
- [ ] 符合NFR (<500ms延迟)  

#### 2.3 优先级排序
优先级排序标准：

| 因素     | 权重 | 描述                          |
|------------|--------|--------------------------------------|
| 覆盖范围      | 30%    | 用户/交易数量         |
| 影响     | 25%    | 对业务指标的影响           |
| 置信度 | 20%    | 估算置信度 (50-100%)    |
| 工作量     | 25%    | 工作量 (SP)                          |

优先级待办列表示例

| ID  | 任务                         | 角色     | SP  | 优先级 | 在冲刺中？ | 工件                          |
|-----|------------------------------|----------|-----|----------|------------|------------------------------------|
| 101 | 支付核心实现  | Backend  | 8   | P0       | ✅         | payment_backend.md#core-logic      |
| 102 | 银行API集成         | Backend  | 5   | P0       | ✅         | payment_openAPI.yaml#bank-api      |
| 103 | 支付表单UI              | Frontend | 3   | P1       | ✅         | payment_sequence.plantuml#ui       |
| 104 | 监控设置             | DevOps   | 3   | P1       | ⚠️ (如有时间) | *_nfr.md#monitoring              |
| 105 | 安全审计               | Security | 2   | P2       | ❌         | *_nfr.md#security-audit           |

说明：
* P0：对启动至关重要（业务需求）
* P1：重要，但可推迟1-2个冲刺
* P2：低优先级（优化）

### 3. 质量指标
* 完整性：100%的任务引用SA工件
* 准确性：与实际工作量相差±2 SP
### 4. 来源和结果

输入数据：SA工件
输出数据：
   /sprint_24-04
    /backlog_prioritized.md
    /gantt_chart.plantuml
    /dependencies.plantuml
    /risk_register.xlsx
    /team_capacity.md  # 按角色分配SP

### 5. 创建规则
对于每个任务：
* 指定SA工件的精确链接
* 计算最小-最大SP并说明理由
风险：
* 概率 (20%/50%/80%)
* 明确触发条件（例如："银行API返回502错误"）

### 6. 模板
#### 6.1 冲刺待办事项模板

文件: {project}_sprint_backlog.md

markdown
冲刺待办事项 {编号}  
**日期:** {YYYY-MM-DD} – {YYYY-MM-DD}  
**目标:** {冲刺目标的简要描述}  


 **估算方法**  
- **1 SP** ≈ 1 天中级开发人员的工作  
- **最小-最大范围**:  
  - **最小**: 理想条件（无阻碍，依赖项已就绪）  
  - **最大**: 考虑风险（集成问题，返工）  


 **优先级排序 (RICE)**  
| 因素       | 权重  | 评估标准                     |  
|--------------|------|-------------------------------------|  
| **覆盖范围**    | 30%  | 用户/事务覆盖范围      |  
| **影响**   | 25%  | 对业务指标的影响           |  
| **置信度** | 20% | 估算置信度 (50-100%)      |  
| **工作量**   | 25%  | 人工成本 (最小-最大 SP)           |  




 **任务**  
| ID  | 名称                     | 角色          | SP (最小-最大) | 优先级 | 状态   | 工件                          |  
|-----|------------------------------|---------------|--------------|-----------|----------|------------------------------------|  
| 101 | 支付核心实现      | Backend       | 8–13         | P0        | 待办    | `payment_backend.md#core-logic`    |  
| 102 | 银行 API 集成       | Backend       | 5–8          | P0        | 待办    | `payment_openAPI.yaml#bank-api`    |  
| 103 | 支付表单 UI           | Frontend      | 3–5          | P1        | 待办    | `payment_sequence.plantuml#ui`     |  




 **SP 总体计划**  
- **乐观 (最小):** 16 SP  
- **现实:** 21 SP  
- **悲观 (最大):** 26 SP  




 **完成标准**  
-  所有任务通过验收测试  
-  无严重错误 (严重性 1-2)  
-  已向利益相关者进行演示  


#### 6.2 任务模板
markdown


TASK-{ID}: {名称}  
**角色**: {Backend/Frontend/QA} ({SP} SP)  
**工件**:  
- 需求: `{file}#{section}`  
- API: `{file}`  
**风险**:  
- {描述} (概率: {X}%, 缓解措施: {操作})  


### 6.3 甘特图模板
#### 6.3.1 在 PlantUML 中创建甘特图的说明

##### 6.3.1.1 引言
    甘特图是一种项目管理工具，在时间轴上显示任务：开始/结束日期、持续时间、序列和任务重叠。PlantUML 提供了一种文本语法来描述甘特图，这对于版本控制和自动生成非常方便。

##### 6.3.1.2 生成图表前询问：
1. 询问用户项目开始日期，没有回答不得开始生成
2. 询问用户需要使用哪种语言创建图表，提供以下选择：
- 俄语
- 英语
- 西班牙语
- 阿拉伯语
- 中文

---

##### 6.3.1.3 在 PlantUML 中生成图表的要求和顺序
1. 创建图表时，应用 KISS 原则（Keep It Simple, Stupid 或 Keep It Short and Simple）——一个基本的设计和开发原则，即大多数系统在保持简单而不是过度复杂化时效果最佳。
2. 生成图表时，遵循以下指导：
- 本说明
- 链接中描述的示例：https://plantuml.com/ru/gantt-diagram
- 禁止偏离本说明和示例
   

##### 6.3.1.4 根据用户回答需要采取的行动：
1. 必须将用户指定的项目开始日期转换为 `YYYY-MM-DD` 格式（例如：`2025-09-25`）并在 `Project starts` 后指定（例如：`Project starts 2025-09-25`）
2. 指定用户的语言，如果指定了：
   - 俄语，则代码中必须包含 `language ru`
   - 英语，则代码中必须包含 `language en`
   - 西班牙语，则代码中必须包含 `language es`
   - 阿拉伯语，则代码中必须包含 `language ar`
   - 中文，则代码中必须包含 `language zh`
3. 使用用户选择的语言生成图表
   

##### 6.3.1.5 语法基础

- 图表以 `@startgantt` / `@endgantt` 块开始和结束。
- 任务在方括号中声明：`[任务名称]`。
- 任务名称必须指明 [名称 ([天数] 天)]


###### 6.3.1.5.1 工作量
要设置持续时间，请使用动词 `requires`：

plantuml
@startgantt
[原型设计] requires 15 days
[测试原型] requires 10 days
-- 所有示例 --
[任务 1 (1 天)] requires 1 day
[任务 2 (5 天)] requires 5 days
[任务 2 (7 天)] requires 1 week
[任务 1 (11 天)] requires 1 week and 4 days
[任务 1 (14 天)] requires 2 weeks
@endgantt


> 注意：一周通常为 7 天，但在有“关闭”日（周末）的情况下，一周可能被解释为 5 个工作日。

###### 6.3.1.5.2 开始 (start)

- 开始日期使用 `start` 设置（绝对日期）
- 禁止使用相对日期 D+N

plantuml
@startgantt
[原型设计] requires 15 days
[测试原型] requires 10 days

Project starts 2020-07-01
[原型设计] starts 2020-07-01
[测试原型] starts 2020-07-16
@endgantt


###### 6.3.1.5.3 结束 (end)

- 结束日期通过 `ends` 设置：
- 禁止使用 D+N 格式的相对结束日期
plantuml
@startgantt
[原型设计] requires 15 days
[测试原型] requires 10 days

Project starts 2020-07-01
[原型设计] ends 2020-07-15
[测试原型] ends 2020-07-25
@endgantt



###### 6.3.1.5.4 同时设置开始和结束 (Start/End)

您可以同时为任务设置 `starts` 和 `ends`：

plantuml
@startgantt
Project starts 2020-07-01
language zh
saturday are closed
sunday are closed
printscale daily zoom 2
[原型设计] starts 2020-07-01
[测试原型] starts 2020-07-16
[原型设计] ends 2020-07-15
[测试原型] ends 2020-07-25
@endgantt


---

###### 6.3.1.5.5 单行声明（使用 `and`）

您可以使用 `and` 将声明合并为一行：

plantuml
@startgantt
Project starts 2020-07-01
language zh
saturday are closed
sunday are closed
printscale daily zoom 2
[原型设计] starts 2020-07-01 and ends 2020-07-15
[测试原型] starts 2020-07-16 and requires 10 days
@endgantt


---

###### 6.3.1.5.6 任务间的约束（依赖关系）

添加约束：

plantuml
@startgantt
[原型设计] requires 15 days
[测试原型] requires 10 days
[测试原型] starts at [原型设计]'s end
@endgantt


链式示例：

plantuml
@startgantt
[原型设计] requires 10 days
[编写原型代码] requires 10 days
[编写测试] requires 5 days
[编写原型代码] starts at [原型设计]'s end
[原型设计] starts at [编写测试]'s end
@endgantt


---

###### 6.3.1.5.7 任务别名 (`as`)

短名称（别名）：

plantuml
@startgantt
[原型设计] as [D] requires 15 days
[测试原型] as [T] requires 10 days
[T] starts at [D]'s end
@endgantt


---

###### 6.3.1.5.8 具有相同名称的任务

从版本 V1.2024.6 开始，您可以通过为每个任务分配单独的别名来创建具有相同显示名称的任务：

plantuml
@startgantt
Project starts 2020-11-08
[任务 7 天] as [T7] starts at 2020-11-09
[T7] ends at 2020-11-15
[任务 7 天] as [T7bis] starts at 2020-11-09
[T7bis] ends at 2020-11-15
@endgantt


或带有颜色/依赖关系的示例：

plantuml
@startgantt
[相同任务名称] as [T1] lasts 7 days and is colored in pink
[相同任务名称] as [T2] lasts 3 days and is colored in orange
[T1] -> [T2]
@endgantt

###### 6.3.1.5.9. 图表标题
- 必须为图表添加标题：`title '甘特图 ([项目名称])'`

示例：
plantuml
@startgantt
title '甘特图 (小圆点销售服务)'
@endgantt


---
##### 6.3.1.6. 质量标准：

1. 已收到用户关于项目开始日期的回复
2. 指定 `is colored in` 时不要使用 `LightCyan` 和 `LightYellow` 颜色
3. 禁止在代码中使用 `start + [数字] days` 的组合，例如 `start + 14 days`
4. 生成图表时，遵循以下指导：
   - 本说明
   - 链接中描述的示例：https://plantuml.com/ru/gantt-diagram
   - 禁止偏离本说明和示例
5. 不使用 `section`
6. 将所有部分命名为 `--**部分**--`，并划分为以下部分：
   - 需求收集与分析
   - 架构设计
   - 开发
   - 集成
   - 测试
   - 部署
   - 项目风险
   - 项目里程碑
7. 图表必须指定用户的语言，如果指定了：
   - 俄语，则代码中必须包含 `language ru`
   - 英语，则代码中必须包含 `language en`
   - 西班牙语，则代码中必须包含 `language es`
   - 阿拉伯语，则代码中必须包含 `language ar`
   - 中文，则代码中必须包含 `language zh`
8. 在代码中将 `--**依赖关系**--` 部分命名为注释 `' 依赖关系`
9. 图表必须包括：`主要任务` 和 `风险`
10. 保存前，必须检查是否严格符合本文档和 PlantUML
11. 图表必须仅以用户选择的语言生成
12. 文件命名如下：
- 如果 `printscale` 指定为 `printscale daily zoom 2`，则文件名为：`[项目名称]_[图表名称]_[文档版本，格式为：v_[次要]_[主要]_[补丁]]_每日_[图表语言].puml`
- 如果 `printscale` 指定为 `printscale printscale weekly zoom 1`，则文件名为：`[项目名称]_[图表名称]_[文档版本，格式为：v_[次要]_[主要]_[补丁]]_每周_[图表语言].puml`

   




#### 6.4 依赖关系图模板


文件: {project}_dependencies.plantuml


plantuml


@startuml {project}_dependencies


title 依赖关系图 - {项目名称}
' 版本: {版本}
' 作者: {全名}


skinparam monochrome true
skinparam arrowColor #2E5A87
skinparam componentStyle uml2


component "[系统]"] as system {
    [组件 A] as compA
    [组件 B] as compB
}


actor "用户" as user
database "外部数据库" as ext_db


user --> compA : "请求"
compA --> compB : "数据"
compB --> ext_db : "同步"


@enduml