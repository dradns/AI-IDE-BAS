# Инструкции по написанию Use Case для ИИ агента

## Содержание
1. [Шаблон Use Case](#шаблон-use-case)
2. [Метрики качества](#метрики-качества)
3. [Валидационные правила](#валидационные-правила)
4. [Примеры Use Case](#примеры-use-case)
5. [Критерии качества](#критерии-качества)

---

## Шаблон Use Case

### Обязательная структура (9 элементов):

| № | Элемент | Описание | Пример |
|---|---------|----------|---------|
| 1 | **Название** | Глагол + Существительное + Контекст | "Создание заказа клиентом" |
| 2 | **User Story (US)** | "Как [роль], я хочу [функциональность], чтобы [ценность]" | US-1: Как клиент, я хочу создать заказ... |
| 3 | **Участники** | Основной актор + вторичные акторы | Клиент, Система, CRM, Email-сервис |
| 4 | **Предусловия** | Что должно быть выполнено до старта | Пользователь авторизован |
| 5 | **Ограничения** | Системные/бизнес ограничения | Максимум 10 товаров в заказе |
| 6 | **Триггер** | Событие, запускающее сценарий | Нажатие кнопки "Оформить заказ" |
| 7 | **Основной сценарий** | Happy path - последовательность шагов | 1. Пользователь выбирает товары... |
| 8 | **Альтернативные сценарии** | Ветвления от основного потока | п.3: Если товара нет в наличии... |
| 9 | **Постусловия** | Результат выполнения сценария | Заказ создан и сохранен в БД |

---

## Метрики качества

### Целевые показатели:
- **Полнота структуры**: 9/9 обязательных элементов = 100%
- **Покрытие сценариев**: Основной + минимум 2 альтернативных = отличное качество
- **Детализация шагов**: 5-15 шагов в основном сценарии = оптимально
- **Связность с архитектурой**: 100% акторов должны присутствовать в системной архитектуре

### Система оценки:
- **Отличное качество**: 90-100% соответствие метрикам
- **Хорошее качество**: 70-89% соответствие метрикам  
- **Требует доработки**: <70% соответствие метрикам

---

## Валидационные правила

### Автоматические проверки:

#### 1. Структурная валидация
```
✓ Все 9 обязательных элементов присутствуют
✓ Название содержит глагол действия
✓ User Story соответствует формату "Как-Хочу-Чтобы"
✓ Минимум 1 основной актор указан
```

#### 2. Логическая валидация
```
✓ Триггер логически связан с основным сценарием
✓ Альтернативные сценарии ссылаются на шаги основного
✓ Постусловия достижимы через основной сценарий
✓ Предусловия не противоречат бизнес-логике
```

#### 3. Интеграционная валидация
```
✓ Акторы соответствуют ролям из User Stories
✓ Системные компоненты есть в архитектурной диаграмме
✓ API методы указаны в технической спецификации
```

---

## Примеры Use Case

### Пример 1: Быстрый запрос обратной связи

| **Элемент** | **Описание** |
|-------------|--------------|
| **Название** | UC-1. Подача быстрого обращения через форму обратной связи |
| **User Story** | US-1: Как пользователь системы, я хочу быстро подать обращение, чтобы сэкономить время на заполнении формы |
| **Участники** | • Основной: Пользователь системы<br>• Вторичные: Веб-интерфейс, Backend API, CRM система |
| **Предусловия** | • Пользователь авторизован<br>• Открыта форма подачи обращения<br>• Фича-тоггл быстрого доступа включен |
| **Ограничения** | • Дровер доступен только при создании обращения<br>• Максимум 5 шаблонов для выбора |
| **Триггер** | Пользователь нажимает элемент быстрого доступа в форме |
| **Основной сценарий** | 1. Пользователь открывает форму подачи обращения<br>2. Система отображает форму с элементом быстрого доступа<br>3. Пользователь нажимает на элемент быстрого доступа<br>4. Система открывает дровер с кнопками-ссылками на шаблоны<br>5. Пользователь выбирает подходящий шаблон<br>6. Система перенаправляет на предзаполненную форму<br>7. Пользователь дополняет недостающие данные<br>8. Система сохраняет обращение |
| **Альтернативные сценарии** | **п.3**: Если пользователь новый → показать уведомление "Поддержка"<br>**п.4**: При загрузке шаблонов → показать лоадер<br>**п.5**: Ошибка 4XX/5XX → сообщение "Ошибка загрузки, попробуйте позже"<br>**п.6**: Закрытие дровера через "X" или клик мимо → возврат к основной форме |
| **Постусловия** | • Обращение создано и сохранено в CRM<br>• Пользователь получил подтверждение<br>• Отправлены метрики использования функции |

### Пример 2: Регистрация пользователя

| **Элемент** | **Описание** |
|-------------|--------------|
| **Название** | UC-2. Регистрация нового пользователя в системе |
| **User Story** | US-2: Как новый пользователь, я хочу зарегистрироваться в системе, чтобы получить доступ к персональным функциям |
| **Участники** | • Основной: Незарегистрированный пользователь<br>• Вторичные: Веб-форма, API регистрации, Email-сервис, База данных |
| **Предусловия** | • Пользователь находится на странице регистрации<br>• Email-сервис доступен<br>• База данных доступна |
| **Ограничения** | • Email должен быть уникальным<br>• Пароль минимум 8 символов<br>• Регистрация доступна только с подтвержденным email |
| **Триггер** | Пользователь нажимает кнопку "Зарегистрироваться" |
| **Основной сценарий** | 1. Пользователь заполняет форму (имя, email, пароль)<br>2. Система валидирует введенные данные<br>3. Система проверяет уникальность email<br>4. Система создает учетную запись со статусом "неподтвержден"<br>5. Система отправляет письмо с подтверждением<br>6. Пользователь переходит по ссылке в письме<br>7. Система активирует учетную запись<br>8. Система отображает сообщение об успешной регистрации |
| **Альтернативные сценарии** | **п.2**: Данные некорректны → показать ошибки валидации<br>**п.3**: Email уже существует → предложить восстановление пароля<br>**п.5**: Ошибка отправки email → сохранить аккаунт, показать инструкции<br>**п.6**: Ссылка истекла → предложить повторную отправку |
| **Постусловия** | • Учетная запись создана и активирована<br>• Пользователь может авторизоваться<br>• Отправлено приветственное письмо |

---

## Критерии качества для ИИ

### 1. Структурные требования
- **Полнота**: Все 9 элементов должны быть заполнены
- **Детализация**: Основной сценарий 5-15 шагов
- **Покрытие**: Минимум 2-3 альтернативных сценария

### 2. Логические требования  
- **Последовательность**: Шаги логически связаны
- **Реалистичность**: Сценарии выполнимы в рамках системы
- **Полнота ветвлений**: Покрыты основные варианты ошибок

### 3. Интеграционные требования
- **Связность**: Акторы соответствуют архитектуре
- **Трассируемость**: Use Case связан с User Story  
- **Техническая реализуемость**: Учтены ограничения системы

### 4. Особые требования
- **Фича-тогглы**: Учитывать условные функции (test:true)
- **Платформенность**: Различия web/mobile указаны явно
- **Обработка ошибок**: Описано поведение при 4XX/5XX
- **UX**: Учтены лоадеры, уведомления, закрытие форм

---

## Чек-лист валидации Use Case

### Обязательная проверка:
- [ ] ✅ Название содержит действие и контекст
- [ ] ✅ User Story в формате "Как-Хочу-Чтобы"  
- [ ] ✅ Указаны все участники (основной + вторичные)
- [ ] ✅ Предусловия достижимы
- [ ] ✅ Ограничения реалистичны
- [ ] ✅ Триггер четко определен
- [ ] ✅ Основной сценарий 5-15 шагов
- [ ] ✅ Альтернативные сценарии ссылаются на основной
- [ ] ✅ Постусловия достижимы

### Качественная проверка:
- [ ] 🎯 Сценарии покрывают 80%+ реальных случаев
- [ ] 🎯 Акторы есть в системной архитектуре  
- [ ] 🎯 Техническая реализуемость подтверждена
- [ ] 🎯 Обработка ошибок детализирована

**Цель**: Создавать Use Case, готовые для передачи в разработку без дополнительных уточнений.